<!DOCTYPE html>
<html>
<head>
<meta content="yes" name="apple-mobile-web-app-capable" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<meta content="minimum-scale=1.0, width=device-width, maximum-scale=0.6667, user-scalable=no" name="viewport" />
<meta name="format-detection" content="telephone=yes" />
<link rel="SHORTCUT ICON" href="favicon.ico">
<link href="favicon.ico" rel="apple-touch-icon" />
<link href="favicon.ico" rel="apple-touch-startup-image" />
<link href="misc/format.css" rel="stylesheet" media="screen" type="text/css" />

<title>Clubs de golf au Québec</title>
<meta content="Golf, Québec, Canada, Golf du Québec, Clubs de golf au Québec, Québec golf" name="keywords" />
<meta content="Répertoire des clubs de golf du Québec." name="description" />
<meta content="Golf, Québec, Canada, Golf du Québec, Clubs de golf au Québec, Québec golf" name="keywords" />
<meta content="Répertoire des clubs de golf du Québec." name="description" />

<script type="text/javascript" src="misc/util.js"></script>
<script type="text/javascript" language="Javascript">
<!--

var userId;
var clubID;
var courseID;
var clubName;
var clubCourse;
var favChange = false;
var newURL ="";
var HOSTserv = localStorage.getItem("HOSTserv");

if (document.images)
{
 favOn= new Image(30,30);
 favOn.src="images/favoris.png";  

 favOff= new Image(30,30);
 favOff.src="images/favorisOff.png";
}

function changeFav(objImg){

if (favChange)
	favChange = false;
else
	favChange = true;

if (objImg.src.indexOf("Off") !=  -1)
	objImg.src = favOn.src;
else
	objImg.src = favOff.src;
}


function majFav(nextURL){
var action;
var imgStat = document.getElementById('favIcon');
//newURL = nextURL;

if (favChange){
	if (imgStat.src.indexOf("Off") !=  -1)
		action=0;  //deleteAction
	else
		action=1;  //addAction

	getInfo("updateFav?data=" + clubID + "$" + userId + "$" + action);
}
}

function initPage(){
var urlInfo = document.location.href;

if (urlInfo.indexOf("data=") == -1){
	var url = window.location.href
	var arr = url.split("/");
	var URLresult = arr[0] + "//" + arr[2] + "/";
	//document.location.href = URLresult;
}else{
	var data = (urlInfo.substring(urlInfo.indexOf("data=") + 5));
}

clubID = parseInt(data);
userId = GetCookie("userID");

getInfo("getClubParc?data=" + clubID + "$" + userId, showClub);

}

function getInfo(path, callback){

var xhr=new XMLHttpRequest();

  xhr.onloadend = function() {
    var text = xhr.responseText;
	var data=JSON.parse(text);
	if (callback)
		callback(data);
  };
xhr.open("GET", HOSTserv + path ,true);
xhr.send();

}

function showClub(oClubParc){
var clubInfo = document.getElementById('clubInfo');
var clubDetail = document.getElementById('clubDetail');
var CourseList = "";

clubCourse = (oClubParc[0].courses);

for (var i = 0; i < clubCourse.length; i++) {
	CourseList += clubCourse[i]._id + "$";
}
CourseList = CourseList.substring(0, CourseList.length - 1 );
getInfo("getBloc?data=" + CourseList, showBlock);

clubName = oClubParc[0].nom;
var cInfo = 'Club:&nbsp;';
if (oClubParc[0].url_club)
	cInfo += '<a target="_blank" href=' + oClubParc[0].url_club + '>' + oClubParc[0].nom + '</a>&nbsp;';
else
	cInfo += oClubParc[0].nom + '&nbsp;';
if (oClubParc[0].prive)
	cInfo += oClubParc[0].prive;
if (userId){
	if (oClubParc[0].isFavorite){
		cInfo += '<img id="favIcon" onclick="changeFav(this)" alt="Favoris" width="30" height="30" src="images/favoris.png" />&nbsp;';
	}else{
		cInfo += '<img id="favIcon" onclick="changeFav(this)" alt="Favoris" width="30" height="30" src="images/favorisOff.png" />&nbsp;';
	}
}
if (false)
	cInfo += '&nbsp;<a class="itin" target="_blank" href="ClubTrajet.asp?Lat=">Trajet</a>';

clubInfo.innerHTML = cInfo;

var cInfo = oClubParc[0].adresse + ',&nbsp;';
if (oClubParc[0].url_ville)
	cInfo += '<a target="_blank" href=' + oClubParc[0].url_ville + '">' + oClubParc[0].municipal + '</a>,&nbsp;';
else
	cInfo += oClubParc[0].municipal + ',&nbsp;';
cInfo += oClubParc[0].codepostal2 + '&nbsp;&nbsp;';
cInfo += oClubParc[0].telephone + '&nbsp;';
if (oClubParc[0].telephone2)
	cInfo += ", " + oClubParc[0].telephone2;
if (oClubParc[0].telephone3)
	cInfo += ", " + oClubParc[0].telephone3;
	
clubDetail.innerHTML = cInfo;

var listParc = document.getElementById('listParc');

for (var p = 0; p < clubCourse.length; p++) {
	var htmlCode = "";
	var parcoursName = "";
	if (clubCourse[p].POINTS == "E")
		htmlCode += "Exécutif,&nbsp;";
	htmlCode += clubCourse[p].PARCOURS;
	if (clubCourse[p].DEPUIS)	
		htmlCode += "&nbsp;depuis&nbsp;" + clubCourse[p].DEPUIS + ",";
	htmlCode += "&nbsp;" + clubCourse[p].TROUS + "&nbsp;trous&nbsp;&#224; normale&nbsp;" + clubCourse[p].NORMALE + "&nbsp;de&nbsp;" + clubCourse[p].VERGES + "&nbsp;verges&nbsp;&nbsp;";
	if (clubCourse[p].PARCOURS != "")
		parcoursName += " - " + clubCourse[p].PARCOURS;
	if (clubCourse[p].golfGPS)
		htmlCode += '<a class="itin" target="_blank" href="golfGPS.html?data=' + clubCourse[p]._id + '&' + clubName + parcoursName + '">Jouer</a>';

	var liElem = document.createElement("li");
	liElem.setAttribute('class', 'listitem');
	liElem.innerHTML = htmlCode;
	listParc.appendChild(liElem);
}

//showBlock();

}

function showBlock(oBlock){
var bloc = oBlock;
var nextCourse = 0;

// Course list
var listParc = document.getElementById('listParc');

for (var p = 0; p < clubCourse.length; p++) {
	var htmlCode = "";
	var courseID = clubCourse[p]._id;
	//var bloc = oBlock[p];

	var b = nextCourse;
	//Bloc list
	if(bloc[b].T14 == null || bloc[b].T14 == 0)
		var nbrTrou = 9;
	else
		var nbrTrou = 18;

	var liElem = document.createElement("li");
	liElem.setAttribute('class', 'listitem');
	var divElem = document.createElement("div");
	divElem.setAttribute('id', 'p1');
	divElem.setAttribute('class', 'cartePts');

	var htmlCode = '<table class="cartePts"><tr><td  class="titre" colspan="14"><b>Parcours&nbsp;&nbsp;' + clubCourse[p].PARCOURS + "&nbsp;" + nbrTrou + '&nbsp;trous</b></td></tr>';
	if(nbrTrou == 9)
		htmlCode += '<tr class="entete"><th>Trou</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>Total</th></tr>';
	else
		htmlCode += '<tr class="entete"><th>Trou</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>Aller</th><td></td><td></td><td></td></tr>';

	
	do{
		var cName = 'B' + bloc[b].Bloc;
		htmlCode += '<tr><td class="' + cName + '">' + bloc[b].Bloc + '</td>';
		for (var i = 1; i < 10; i++) {
			var x = "bloc[b].T" + i;
			htmlCode += '<td>' + eval(x) + '</td>';
		}
		if(nbrTrou == 9)
			htmlCode += '<td>' + bloc[b].Aller + '</td>';
		else
			htmlCode += '<td>' + bloc[b].Aller + '</td><td></td><td></td><td></td>';
	b += 1;
	} while ( bloc[b] && bloc[b].PARCOURS_ID == courseID);

	if(nbrTrou == 18){
		htmlCode += '<tr class="entete"><th>Trou</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th><th>16</th><th>17</th><th>18</th><th>Retour</th><th>Total</th><th>Eval.</th><th>Slope</th></tr>';
		var b = nextCourse;
		do{
			var cName = 'B' + bloc[b].Bloc;
			htmlCode += '<tr><td class="' + cName + '">' + bloc[b].Bloc + '</td>';
			for (var i = 10; i < 19; i++) {
				var x = "bloc[b].T" + i;
				htmlCode += '<td>' + eval(x) + '</td>';
			}
			htmlCode += '<td>' + bloc[b].Retour + '</td><td>' + bloc[b].Total + '</td><td>' + bloc[b].Eval + '</td><td>' + bloc[b].Slope + '</td>';
		b += 1;
		} while ( bloc[b] && bloc[b].PARCOURS_ID == courseID);
	}
	nextCourse = b;
	htmlCode += '</table>';
	divElem.innerHTML = htmlCode;
	liElem.appendChild(divElem);
	listParc.appendChild(liElem);
}
var chargement = document.getElementById('chargement');
chargement.style.display = "none";
}

// -->
</script>
</head>

<body onload="initPage()"><a name="haut"></a>

<div id="topbar" class="vert">
<div id="leftnav"><a title="Formulaire de recherche" href="index.html" onclick="majFav();"><img alt="Formulaire de recherche" height="22" width="25" src="images/home22.png" /></a></div>
<div id="chargement" class="textBlink">Chargement...</div>
<button type="button" id="rightnav" title="Taille de police" onclick="changeTaille();"><img id="imgTaille" alt="Taille de police" height="20" width="45" src="images/taille.png" /></button>
</div>
<div id="duobutton">
<a href="listeResult.html" onclick="majFav();">Liste</a>
<a id="mapLink" href="ClubMap.asp?" onclick="majFav();">Carte</a></div>


<div id="content">

<ul id="listParc" class="pageitem">
			<li class="listitem">			
			<div id="clubInfo" class="itemdesc">
			</div>
			<div id="clubDetail" class="itemdetail">
			</div>
			</li>
</ul>

</div>

<div id="bottombar" class="vert">
	<div id="rightbutton"> <a href="#haut"><img alt="Haut de page" src="images/haut.png" /></a> </div>
	<div id="message"></div>
</div>

<div id="copyright">
<a href="mailto:cdore00@yahoo.ca?Subject=Golfs%20du%20Qu&eacute;bec">Copyright &copy; 2005-2017</a>
</div>
</body>

</html>